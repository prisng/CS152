object dds {
  /********** #1 **********/
  // Tail-recursive implementation of controlLoop
	def controlLoop[S](state: S, cycle: Int, halt: (S, Int) => Boolean, update: (S, Int) => S): S =
		if (halt(state, cycle)) state
		else controlLoop(update(state, cycle), cycle + 1, halt, update)
                                                  //> controlLoop: [S](state: S, cycle: Int, halt: (S, Int) => Boolean, update: (S
                                                  //| , Int) => S)S
		
  /********** #2 **********/
  // initial pop = 1
  // doubles every week
  // stops at 10^5 (halt / carrying capacity)
  // final size?
  
  val birthRate = 2                               //> birthRate  : Int = 2
  def updatePop(currentPop: Int, maxPop: Int) = {
		println("currentPop = " + currentPop)
		(currentPop * birthRate).toInt
  }                                               //> updatePop: (currentPop: Int, maxPop: Int)Int
	def stopDemo(currentPop: Int, maxPop: Int) =
		(maxPop > scala.math.pow(10, 5))  //> stopDemo: (currentPop: Int, maxPop: Int)Boolean
	controlLoop(1, 0, stopDemo, updatePop)    //> currentPop = 1
                                                  //| currentPop = 3
                                                  //| currentPop = 9
                                                  //| currentPop = 27
                                                  //| currentPop = 81
                                                  //| currentPop = 243
                                                  //| currentPop = 729
                                                  //| currentPop = 2187
                                                  //| currentPop = 6561
                                                  //| currentPop = 19683
                                                  //| currentPop = 59049
                                                  //| currentPop = 177147
                                                  //| currentPop = 531441
                                                  //| currentPop = 1594323
                                                  //| currentPop = 4782969
                                                  //| currentPop = 14348907
                                                  //| currentPop = 43046721
                                                  //| currentPop = 129140163
                                                  //| currentPop = 387420489
                                                  //| currentPop = 1162261467
                                                  //| currentPop = -808182895
                                                  //| currentPop = 1870418611
                                                  //| currentPop = 1316288537
                                                  //| currentPop = -346101685
                                                  //| currentPop = -1038305055
                                                  //| currentPop = 1180052131
                                                  //| currentPop = -754810903
                                                  //| currentPop = 2030534587
                                                  //| currentPop = 1796636465
                                                  //| currentPop = 1094942099
                                                  //| currentPop = -1010140999
                                                  //| currentPop = 1264544299
                                                  //| currentPop = -501334399
                                                  //| currentPop = -1504003197
                                                  //| currentPop = -217042295
                                                  //| currentPop = -651126885
                                                  //| currentPop = -1953380655
                                                  //| currentPop = -1565174669
                                                  //| currentPop = -400556711
  /********** #3 **********/
  
  /********** #4 **********/
  
  /********** #5 **********/
  
  /********** #6 **********/
  
}